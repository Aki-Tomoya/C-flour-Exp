1.Redis脑裂是什么

当发生网络分区时，老的 redis leader 可能在一段时间内并不知道新的 leader 已经被选举出来，这时候客户端在老的 leader 上可能会读取出陈旧的数据，这就是redis的脑裂。

raft使用过半票决的机制避免脑裂。服务器数量必须是奇数的，而在follower开启选举机制时，要先经过收集大于1/2的选票，才能当选leader.而在此之前，还要经过prevote机制，确认自己能够收集到大多数节点的回复，从而确认自己可以进行选举。

2.如果一个leader宕机一段时间后恢复，会发生什么

如果一个leader宕机了一段时间，可能其集群已经重新发起选举流程， 并选出了一个新的leader，此时旧会尝试发送心跳消息。但是，它会从返回消息中发现自己的Term和Index已经过时，并在接收到新Leader的心跳消息后，并转变为Follower状态。

3.什么是跳表

跳表（Skip List）是一种数据结构，它允许快速地查找、插入和删除元素。跳表的基本思想是通过在有序链表上方增加多层索引，以实现快速的搜索。每一层都是原始链表的一个子集，最底层包含所有元素，而更高的层次包含较少的元素，通过这些层次化的索引，跳表能够在较快的时间内定位到目标元素。

4.跳表和链表有什么区别

空间复杂度：跳表在链表的基础上增加了多层索引，因此空间复杂度会更高，但是依然是线性的。

时间复杂度：在链表头尾插入节点复杂度为O(1),而跳表的时间复杂度为O(logn)

链表会占用更大的空间，但会极高的提速。



5.跳表中有哪些数据结构

跳表中可以存储很多数据结构。比如存储redis的五种类型，string,list,set,Zset,Hash.



6.跳表的数据结构是什么

a.链表：跳表的本质就是多个链表

b.节点：跳表的每个节点通常包含两部分信息，一部分是数据本身，另一部分是指向下一个节点的指针

c.索引层级：每一层级都是原始链表的一个快照，其中的节点是原始链表节点的子集。

d.头结点和尾结点： 跳表通常有一个头节点和一个尾节点，它们不包含实际的数据，只是作为跳表的入口和结束点。

e.索引节点：这些节点连接不同层级的链表



7.画一下跳表



8.多态在项目中如何实现的

⾸先是封装，我在项⽬中将各个模块使⽤类进⾏封装，⽐如连接⽤ httpconnection/ftpconnection 类来封装，⽇志就⽤ log 类来封装，将类的属性私有化，⽐如请求的解析状态，并且对外的接⼝设置为公有，⽐如连接的重置，不对外暴露⾃身的私有⽅法，⽐如读写的回调函数等。还有⼀个就是，项⽬中每个模块都使⽤了各⾃的命名空间进⾏封装，避免了命名冲突或者名字污染。

然后是继承，项⽬中的继承⽤得⽐较少，主要是对⼯具类的继承，项⽬中多个地⽅使⽤到 noncopyable 和enable_shared_from_this，保证了代码的复⽤性。实际上对共有功能可以设计⼀个基类来继承，⽐如我项⽬中的connection⽬前有 httpconnection 和 tcpconnection 两种，可以通过继承 connection 基类来减少重复代码，因为我当时做的时候只考虑到 http连接，ftp是后⾯加上去的，所以就没⽤这样设计，后⾯可以优化⼀下。

最后是多态，我项⽬中的多态主要⽤了静态多态，动态多态没有涉及。静态多态在⽇志系统中对流输⼊运算符进⾏了重载，以及在⽇志系统和内存池中都有各种函数模板的泛型编程。实际上刚刚说的 httpconnection 和ftpconnection 从 connection 派⽣出来后是可以使⽤动态多态的。

9.虚函数的概念

在 C++ 中，将基类中的成员函数声明为虚函数可以实现多态性。派生类可以覆盖（Override）基类中的虚函数，从而提供自己特定的实现。当使用基类指针或引用调用虚函数时，会根据实际对象的类型来决定调用哪个版本的函数，这就是动态绑定

10.使用父类类型定义的子类对象如何调用到自己的虚函数

多态性体现在具有继承关系的父类和子类之间，父类把成员函数声明为虚函数，子类重写父类的成员函数，在程序运行时期，找到动态绑定到父类指针上的对象（可能是某个子类对象，也可能是父类对象），然后系统内部查一个虚函数表，找到函数的入口地址，从而通过父类指针调用父类或者子类的成员函数，这就是运行时期的多态性。


11.讲讲TCP的头部

源端口

目标端口

序列号	确认号

数据偏移	保留位

五个控制位：ACK SYN FIN RST URG PSH

窗口大小    校验和     紧急指针



 12.为什么要随机初始化序列号

防止历史连接。